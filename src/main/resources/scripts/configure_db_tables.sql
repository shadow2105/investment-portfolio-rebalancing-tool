create table admin_profiles (id BINARY(16) not null, user_id BINARY(16) not null, primary key (id)) engine=InnoDB;
create table dashboard_widgets (id BINARY(16) not null, user_profile_id BINARY(16) not null, widget_description enum ('ACCOUNTS_ASSET_CLASS_ALLOCATION','ACCOUNTS_COUNTRY_ALLOCATION','ACCOUNTS_SECTOR_ALLOCATION','ASSET_CLASS_BASED_REBALANCING_TEMPLATES','COUNTRY_BASED_REBALANCING_TEMPLATES','RECENTLY_ADDED_INVESTMENT_ACCOUNTS','SECTOR_BASED_REBALANCING_TEMPLATES') not null, primary key (id)) engine=InnoDB;
create table registered_users (created_at datetime(6), updated_at datetime(6), id BINARY(16) not null, created_by varchar(255), email varchar(255) not null, family_name varchar(255), given_name varchar(255) not null, locale varchar(255), middle_name varchar(255), profile_picture varchar(255), role enum ('ADMIN','USER') not null, updated_by varchar(255), username varchar(255) not null, primary key (id)) engine=InnoDB;
create table user_assets (number_of_units decimal(20,4) not null, value_per_unit decimal(20,2) not null, investment_account_id binary(16) not null, asset_class enum ('CASH','COMMODITY','EQUITY','FIXED_INCOME','REAL_ESTATE','UNKNOWN') not null, asset_name varchar(255) not null, country enum ('CA','UNKNOWN','US'), primary key (investment_account_id, asset_name)) engine=InnoDB;
create table user_assets_equities (investment_account_id binary(16) not null, asset_name varchar(255) not null, company_name varchar(255), industry varchar(255), sector enum ('COMMUNICATION_SERVICES','CONSUMER_DISCRETIONARY','CONSUMER_STAPLES','ENERGY','FINANCIALS','HEALTHCARE','INDUSTRIALS','INFORMATION_TECHNOLOGY','MATERIALS','REAL_ESTATE','UNKNOWN','UTILITIES'), symbol varchar(255) not null, primary key (investment_account_id, asset_name)) engine=InnoDB;
create table user_investment_accounts (account_value decimal(38,2), created_at datetime(6), updated_at datetime(6), id BINARY(16) not null, user_profile_id BINARY(16), account_holder_first_name varchar(255) not null, account_holder_last_name varchar(255) not null, account_number varchar(255) not null, created_by varchar(255), updated_by varchar(255), primary key (id)) engine=InnoDB;
create table user_profiles (id BINARY(16) not null, user_id BINARY(16) not null, primary key (id)) engine=InnoDB;
create table user_rebalance_config_templates (created_at datetime(6), updated_at datetime(6), user_profile_id binary(16) not null, created_by varchar(255), template_name varchar(255) not null, template_type enum ('ASSET_CLASS','COUNTRY','EQUITY_SECTOR') not null, updated_by varchar(255), primary key (user_profile_id, template_name)) engine=InnoDB;
create table user_rebalance_config_templates_asset_class (percent_cash float(53) not null, percent_commodity float(53) not null, percent_equity float(53) not null, percent_fixed_income float(53) not null, percent_real_estate float(53) not null, percent_unknown float(53) not null, user_profile_id binary(16) not null, template_name varchar(255) not null, primary key (user_profile_id, template_name)) engine=InnoDB;
create table user_rebalance_config_templates_country (percent_ca float(53) not null, percent_unknown float(53) not null, percent_us float(53) not null, user_profile_id binary(16) not null, template_name varchar(255) not null, primary key (user_profile_id, template_name)) engine=InnoDB;
create table user_rebalance_config_templates_sector (percent_communication_services float(53) not null, percent_consumer_discretionary float(53) not null, percent_consumer_staples float(53) not null, percent_energy float(53) not null, percent_financials float(53) not null, percent_healthcare float(53) not null, percent_industrials float(53) not null, percent_information_technology float(53) not null, percent_materials float(53) not null, percent_real_estate float(53) not null, percent_unknown float(53) not null, percent_utilities float(53) not null, user_profile_id binary(16) not null, template_name varchar(255) not null, primary key (user_profile_id, template_name)) engine=InnoDB;
alter table admin_profiles add constraint UK_ss7cv5tvqvefq889gxgns5g2y unique (user_id);
alter table registered_users add constraint UK_jtxc3uqje20eor9u76gdkj2cn unique (email);
alter table registered_users add constraint UK_ktq291q5arxd6xvrdc1299huk unique (username);
alter table user_investment_accounts add constraint UK_h184paq7e0uqp51vco0ou3khx unique (account_number);
alter table user_profiles add constraint UK_e5h89rk3ijvdmaiig4srogdc6 unique (user_id);
alter table admin_profiles add constraint FKfx0bexrx0hbamujg90n1d6gyb foreign key (user_id) references registered_users (id);
alter table dashboard_widgets add constraint FKlsrhlo2hmvokefg54br6tvnba foreign key (user_profile_id) references user_profiles (id);
alter table user_assets add constraint FK9jpke032jpv8t9srqalurftkp foreign key (investment_account_id) references user_investment_accounts (id);
alter table user_assets_equities add constraint FKoimf6nqisj8jxmgj1t7c7stet foreign key (investment_account_id, asset_name) references user_assets (investment_account_id, asset_name);
alter table user_investment_accounts add constraint FKb6qlouk66eoh6siwxsj4d0t8s foreign key (user_profile_id) references user_profiles (id);
alter table user_profiles add constraint FK8dtgsdjrx9fgs7ibhne60tt9s foreign key (user_id) references registered_users (id);
alter table user_rebalance_config_templates add constraint FKgmujgijwop6ucsq12xxqcqhfg foreign key (user_profile_id) references user_profiles (id);
alter table user_rebalance_config_templates_asset_class add constraint FKrts6nnrwfopp7ruujdgxq1er9 foreign key (user_profile_id, template_name) references user_rebalance_config_templates (user_profile_id, template_name);
alter table user_rebalance_config_templates_country add constraint FKoa6fq248dyefcs51kxeb61y92 foreign key (user_profile_id, template_name) references user_rebalance_config_templates (user_profile_id, template_name);
alter table user_rebalance_config_templates_sector add constraint FK5hwev5mqjn3i7twtmvusrgf9j foreign key (user_profile_id, template_name) references user_rebalance_config_templates (user_profile_id, template_name);
